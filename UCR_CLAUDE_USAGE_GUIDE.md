# UCR機能のClaude操作ガイド

## 概要

intervals-mcp-serverにUCR（Unified Continuous Readiness）機能が統合されました。朝の30分間でウェルネスデータを入力し、UCR評価を確認して、トレーニング実施の判断を支援します。

## 朝のワークフロー例

### 1. 基本的なUCR評価の確認

```
今日のUCR評価を教えてください
```

Claudeが`get_ucr_assessment`ツールを実行し、以下の情報を提供：
- UCRスコア（0-100点）
- トレーニング推奨ゾーン（プライム/中程度/低い）
- 各コンポーネントスコア（HRV、RHR、睡眠、主観的評価）
- トレンド分析（モメンタム、ボラティリティ）

### 2. ウェルネスデータ更新とUCR再計算

```
今朝の体調を更新してください。疲労度2、ストレス2、モチベーション3、筋肉痛1、ケガなしです。
```

Claudeが`update_wellness_assessment`ツールを実行し：
- 主観的ウェルネスデータを更新
- UCR評価を再計算
- 更新後のスコアと推奨を表示

### 3. トレンド分析の詳細確認

```
UCRのトレンド分析を詳しく見せてください
```

Claudeが`calculate_ucr_trends`ツールを実行し：
- 7日間モメンタム（変化率）
- 14日間ボラティリティ（変動性）
- 27ステート解釈マトリクス
- ボリンジャーバンドによる安定性評価

## 利用可能なMCPツール

### 1. get_ucr_assessment
**用途**: 基本的なUCR評価取得  
**パラメータ**:
- `date`: 評価日（省略時は今日）
- `include_trends`: トレンド分析を含むか（デフォルト: true）
- `update_intervals`: intervals.icuに保存するか（デフォルト: false）

**例**:
```
get_ucr_assessment(date="2025-01-15", include_trends=true, update_intervals=true)
```

### 2. update_wellness_assessment
**用途**: 主観的データ更新とUCR再計算  
**パラメータ**:
- `date`: 更新日（省略時は今日）
- `fatigue`: 疲労度（1-4、1=とても疲れている、4=とてもフレッシュ）
- `stress`: ストレス（1-4、1=とてもストレス、4=とても穏やか）
- `motivation`: モチベーション（1-4）
- `soreness`: 筋肉痛（1-4）
- `injury`: ケガ（1-4）

**例**:
```
update_wellness_assessment(fatigue=2, stress=3, motivation=4, soreness=1, injury=4)
```

### 3. calculate_ucr_trends
**用途**: 詳細なトレンド分析  
**パラメータ**:
- `target_date`: 分析対象日（省略時は今日）
- `update_intervals`: intervals.icuに保存するか（デフォルト: true）

### 4. check_ucr_setup
**用途**: UCR機能の設定状況確認  
intervals.icuのカスタムフィールド設定を確認

### 5. batch_calculate_ucr
**用途**: 期間指定でのUCR一括計算  
**パラメータ**:
- `start_date`: 開始日（必須）
- `end_date`: 終了日（省略時は今日）
- `update_intervals`: intervals.icuに保存するか

## Claude会話の例

### 朝の基本チェック

**ユーザー**: おはようございます。今朝のUCR評価はどうですか？

**Claude**: おはようございます！今朝のUCR評価を確認いたします。

`get_ucr_assessment`を実行...

今日のUCR評価結果：
- **UCRスコア**: 78点
- **推奨ゾーン**: 中程度
- **推奨アクション**: 高強度は可能だが、注意深い自己調整が必須

コンポーネント詳細：
- HRV: 32/40点
- RHR: 16/20点  
- 睡眠: 15/20点
- 主観的評価: 15/20点

トレンド分析：
- モメンタム: +3.2%（過去7日間で上昇傾向）
- ボラティリティ: 2.8（標準的な変動）
- トレンドステート: 生産的なリバウンド

予定通りのトレーニングは可能ですが、体調の変化に注意を払いながら実施することをお勧めします。

### 体調更新とチェック

**ユーザー**: 今朝は少し疲れています。疲労度2、ストレス3で更新してください。

**Claude**: 体調を更新してUCR評価を再計算いたします。

`update_wellness_assessment`を実行...

ウェルネスデータを更新しました：
- 疲労度: 2（やや疲れている）
- ストレス: 3（標準的）

更新後のUCR評価：
- **UCRスコア**: 74点（更新前: 78点）
- **推奨ゾーン**: 中程度（変更なし）

疲労度の更新により4点のスコア低下がありました。今日のトレーニングは少し軽めにするか、体調の変化により一層注意を払うことをお勧めします。

### トレンド詳細分析

**ユーザー**: 最近のコンディションの変化をもっと詳しく教えてください。

**Claude**: UCRトレンドの詳細分析を実施いたします。

`calculate_ucr_trends`を実行...

**詳細トレンド分析結果**：

**モメンタム分析**：
- 7日間変化率: +3.2%
- カテゴリ: 正の傾向
- 解釈: 疲労から順調に回復している

**ボラティリティ分析**：
- 14日間ボラティリティ: 2.8
- レベル: MODERATE（標準的な変動）
- ボリンジャーバンド位置: -0.3σ（中心線付近）
- 解釈: 日々の変動は正常な回復プロセスの一部

**総合解釈**：
UCRスコア74点で過去7日間+3.2%の上昇。『生産的なリバウンド』の状態で、標準的な回復。疲労から順調に回復している。日々の変動は正常な回復プロセスの一部。計画通り負荷を戻して良い。

過去1週間で着実に回復が進んでおり、今後数日でさらなる改善が期待できます。

## intervals.icuカスタムフィールド設定

UCR機能を完全に活用するには、intervals.icuに以下のカスタムフィールドを設定してください：

### 必要なカスタムフィールド

1. **UCRMomentum** (数値型)
   - UCRモメンタムのパーセンテージ値

2. **UCRVolatility** (数値型)  
   - UCRボラティリティ値

3. **UCRTrendState** (選択型)
   - 9つのトレンドステートから選択
   - オプション: 1-9の数値

4. **UCRTrendInterpretation** (テキスト型)
   - 詳細な解釈とアドバイス

5. **UCRVolatilityLevel** (テキスト型)
   - HIGH/MODERATE/LOW

6. **UCRVolatilityBandPosition** (数値型)
   - ボリンジャーバンド内での位置

### 設定確認方法

```
UCRの設定状況を確認してください
```

Claudeが`check_ucr_setup`を実行し、設定状況と推奨事項を表示します。

## トラブルシューティング

### よくある問題

1. **データ不足エラー**
   - 症状: "トレンド分析には最低15日分のデータが必要"
   - 対処: intervals.icuでより多くのウェルネスデータを蓄積

2. **カスタムフィールド未設定**
   - 症状: トレンド情報がintervals.icuに保存されない
   - 対処: 上記のカスタムフィールドを設定

3. **API認証エラー**
   - 症状: "Authentication required for MCP access"
   - 対処: intervals-mcp-serverの認証を確認

### デバッグ用コマンド

```
UCRシステムの状態を詳しく確認してください
```

```
過去7日間のUCR履歴を一括で確認してください
```

## 期待される効果

### 従来のワークフロー（GAS手動実行）
1. Google Sheetsを開く
2. GASスクリプトを手動実行
3. 結果をシートで確認
4. 別途Claudeに相談

**所要時間**: 約10-15分

### 新しいワークフロー（MCP統合）
1. Claudeに朝の体調を伝える
2. UCR評価とトレーニング推奨を取得
3. 必要に応じて詳細分析を確認

**所要時間**: 約3-5分

**時間短縮**: 50-67%の効率化

### その他の効果
- **即座の意思決定**: 客観的なデータに基づく判断
- **継続的なモニタリング**: トレンド変化の早期発見
- **統合された体験**: intervals.icuエコシステムとの完全連携

このUCR統合により、朝のトレーニング判断がより迅速かつ客観的になり、コンディション管理の質が向上します。